import{d as e,k as t,D as a,l as r,I as s,a9 as l,o as n,c as o,w as i,a as u,n as c,G as d,y as f,x as p,b as v,t as m,P as h,i as x,an as y,N as _,A as b,u as g,L as k,_ as w,m as C,E as S}from"./index-f30f5313.js";import{s as z,m as P,t as R,w as L,i as F,j as M,y as N,o as j,r as I,a as U,_ as A}from"./DemoPage.cf3c40e0.js";import{u as O}from"./use-id.cdfa0884.js";const W=w(e({name:"ZCircle",options:{virtualHost:!0},props:{text:String,type:z(""),size:P(100),fill:z(""),rate:P(100),speed:P(50),color:{type:[String,Object],default:"#1989fa"},clockwise:R,layerColor:z("#ffffff"),currentRate:L(0),strokeWidth:P(4),strokeLinecap:String,startPosition:z("top"),lineCap:z("round")},emits:["update:currentRate"],setup(e,{emit:w}){const C=2*Math.PI,S=-Math.PI/2,z=e=>Math.min(Math.max(e,0),100),[P,R]=F("circle");M(P);const L=k(),I=e,U=w,A=O();let W;const G=t("#1989fa"),T=t(0),B=()=>{const{type:e,size:t}=I;if(""===e){const e=_(A,L);return Promise.resolve(e)}const a=b().pixelRatio;return new Promise((r=>{g().in(L).select(`#${A}`).node((s=>{const l=s[0].node,n=l.getContext(e);W||(W=!0,l.width=t*a,l.height=t*a,n.scale(a,a)),r(Z(n))})).exec()}))},D=a((()=>{const e={top:0,right:90,bottom:180,left:270}[I.startPosition];if(e)return{transform:`rotate(${e}deg)`}})),$=()=>{const{color:e,size:t}=I;return j(e)?B().then((a=>{if(!a)return;const r=a.createLinearGradient(t,0,0,0);Object.keys(e).sort(((e,t)=>parseFloat(e)-parseFloat(t))).map((t=>r.addColorStop(parseFloat(t)/100,e[t]))),G.value=r})):(G.value=e,Promise.resolve())},J=e=>{const{size:t}=I;B().then((a=>{if(!a)return;a.clearRect(0,0,t,t),(e=>{const{layerColor:t,fill:a}=I;Y(e,t,0,C,a)})(a);((e,t)=>{const{clockwise:a}=I,r=C*(t/100),s=a?S+r:3*Math.PI-(S+r);Y(e,G.value,S,s)})(a,z(e)),U("update:currentRate",z(parseFloat(I.rate.toFixed(1)))),a.draw()}))};let E=t();const H=()=>{const{rate:e,speed:t}=I;if(Number(t)<=0||Number(t)>1e3)return void J(e);if(T.value==e)return void J(e);X();const a=()=>{E.value=setTimeout((()=>{T.value!==e?(Math.abs(T.value-Number(e))<1?T.value=Number(e):T.value<Number(e)?T.value+=1:T.value-=1,J(T.value),a()):X()}),1e3/Number(t))};a()},X=()=>{E.value&&(clearTimeout(E.value),E.value=null)},Y=(e,t,a,r,s)=>{const{strokeWidth:l,lineCap:n,clockwise:o,size:i}=I,u=i/2,c=u-l/2;e.setStrokeStyle(t),e.setLineWidth(l),e.setLineCap(n),e.beginPath(),e.arc(u,u,c,a,r,!o),e.stroke(),s&&(e.setFillStyle(s),e.fill())},Z=e=>Object.assign(e,{setStrokeStyle(t){e.strokeStyle=t},setLineWidth(t){e.lineWidth=t},setLineCap(t){e.lineCap=t},setFillStyle(t){e.fillStyle=t},setFontSize(t){e.font=String(t)},setGlobalAlpha(t){e.globalAlpha=t},setLineJoin(t){e.lineJoin=t},setTextAlign(t){e.textAlign=t},setMiterLimit(t){e.miterLimit=t},setShadow(t,a,r,s){e.shadowOffsetX=t,e.shadowOffsetY=a,e.shadowBlur=r,e.shadowColor=s},setTextBaseline(t){e.textBaseline=t},createCircularGradient(){},draw(){}});return r((()=>I.size),(()=>{H()})),r((()=>I.rate),(()=>{H()})),r((()=>I.color),(()=>{$().then((()=>{H()}))})),s((()=>{T.value=Number(I.currentRate),$().then((()=>{H()}))})),l((()=>{X()})),(t,a)=>{const r=h,s=x,l=y;return n(),o(s,{class:c(d(R)())},{default:i((()=>[u(r,{class:c(d(R)("canvas")),type:e.type,style:f([{width:d(N)(e.size),height:d(N)(e.size)},D.value]),id:d(A),"canvas-id":d(A)},null,8,["class","type","style","id","canvas-id"]),e.text?(n(),o(l,{key:1,class:c(d(R)("text"))},{default:i((()=>[v(m(e.text),1)])),_:1},8,["class"])):(n(),o(s,{key:0,class:c(d(R)("text"))},{default:i((()=>[p(t.$slots,"default",{},void 0,!0)])),_:3},8,["class"]))])),_:3},8,["class"])}}}),[["__scopeId","data-v-5e94b93f"]]),G=w(e({__name:"circle",setup(e){const a=t(70),r=t(0),s=t(70),l=t(70),c=t(70),d={"0%":"#3fecff","100%":"#6149f6"},f=e=>Math.min(Math.max(e,0),100),p=()=>{a.value=f(a.value+20)},v=()=>{a.value=f(a.value-20)};return(e,t)=>{const f=I(C("z-circle"),W),m=S("demo-block"),h=x,y=I(C("z-button"),U),_=I(C("DemoPage"),A);return n(),o(_,{title:"Circle"},{default:i((()=>[u(h,{class:"demo-circle"},{default:i((()=>[u(m,{title:"基础用法"},{default:i((()=>[u(f,{"current-rate":r.value,"onUpdate:currentRate":t[0]||(t[0]=e=>r.value=e),rate:a.value,speed:100,text:r.value.toFixed(0)+"%"},null,8,["current-rate","rate","text"])])),_:1}),u(m,{title:"自定义样式"},{default:i((()=>[u(h,{class:"content"},{default:i((()=>[u(h,{class:"content-item"},{default:i((()=>[u(f,{"current-rate":l.value,"onUpdate:currentRate":t[1]||(t[1]=e=>l.value=e),rate:a.value,speed:100,"stroke-width":10,text:"宽度定制"},null,8,["current-rate","rate"])])),_:1}),u(h,{class:"content-item"},{default:i((()=>[u(f,{"current-rate":l.value,"onUpdate:currentRate":t[2]||(t[2]=e=>l.value=e),color:"#ee0a24",rate:a.value,"layer-color":"#ebedf0",speed:100,text:"颜色定制"},null,8,["current-rate","rate"])])),_:1}),u(h,{class:"content-item"},{default:i((()=>[u(f,{"current-rate":s.value,"onUpdate:currentRate":t[3]||(t[3]=e=>s.value=e),rate:a.value,speed:100,color:d,text:"渐变色"},null,8,["current-rate","rate"])])),_:1}),u(h,{class:"content-item"},{default:i((()=>[u(f,{"current-rate":c.value,"onUpdate:currentRate":t[4]||(t[4]=e=>c.value=e),color:"#07c160",rate:a.value,speed:100,clockwise:!1,text:"逆时针"},null,8,["current-rate","rate"])])),_:1}),u(h,{class:"content-item"},{default:i((()=>[u(f,{"current-rate":c.value,"onUpdate:currentRate":t[5]||(t[5]=e=>c.value=e),color:"#7232dd",rate:a.value,speed:100,size:140,text:"大小定制"},null,8,["current-rate","rate"])])),_:1})])),_:1}),u(h,{style:{"margin-top":"30rpx"}},{default:i((()=>[u(y,{text:"增加",type:"primary",size:"small",onClick:p}),u(y,{"custom-style":{"margin-left":"30rpx"},text:"减少",type:"danger",size:"small",onClick:v})])),_:1})])),_:1}),u(m,{title:"起始位置"},{default:i((()=>[u(h,{class:"content"},{default:i((()=>[u(h,{class:"content-item"},{default:i((()=>[u(f,{"current-rate":75,rate:a.value,text:"左侧","start-position":"left"},null,8,["rate"])])),_:1}),u(h,{class:"content-item"},{default:i((()=>[u(f,{"current-rate":75,rate:a.value,text:"右侧","start-position":"right"},null,8,["rate"])])),_:1}),u(h,{class:"content-item"},{default:i((()=>[u(f,{"current-rate":75,rate:a.value,text:"底部","start-position":"bottom"},null,8,["rate"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-5cf475f3"]]);export{G as default};
