import{d as a,k as e,D as t,l,o as s,c as o,w as n,a as r,n as u,G as i,z as c,x as d,y as h,i as m,S as g,_ as f,m as v,e as p,r as _,F as b,b as x,t as j,A as z,C as y}from"./index-f30f5313.js";import{_ as P}from"./z-cell.b545d216.js";import{m as C,l as D,t as T,i as k,j as F,L as M,y as w,r as A,_ as B}from"./DemoPage.cf3c40e0.js";import{_ as I}from"./z-cell-group.5d2aafb4.js";import{u as S}from"./use-sync-prop-ref.7ee3c810.js";import{u as $}from"./use-touch.6469fcb8.js";import{c as H}from"./closest.9c1a5909.js";import{_ as Y,a as G}from"./z-tabs.b35f9c58.js";import"./useParent.17bb91a9.js";import"./use-id.cdfa0884.js";import"./useChildren.47d4431b.js";import"./z-sticky.f67df7ce.js";const J=f(a({name:"ZFloatingPanel",options:{virtualHost:!0},props:{height:C(0),anchors:D(),duration:C(.3),contentDraggable:T,lockScroll:Boolean,safeAreaInsetBottom:T},emits:["heightChange","update:height"],setup(a,{emit:f}){const v=a,p=e(!1),[_,b]=k("floating-panel");F(_);const x=f,j=S((()=>+v.height),(a=>x("update:height",a))),z=t((()=>({min:v.anchors[0]?v.anchors[0]:100,max:v.anchors[v.anchors.length-1]?v.anchors[v.anchors.length-1]:Math.round(.6*M.value)}))),y=t((()=>v.anchors.length>=2?v.anchors:[z.value.min,z.value.max])),P=e(!1),C=t((()=>({height:w(z.value.max),transform:`translateY(calc(100% + ${w(-j.value)}))`,transition:P.value?"none":`transform ${v.duration}s cubic-bezier(0.18, 0.89, 0.32, 1.28)`})));let D;const T=$(),A=a=>{T.start(a),P.value=!0,D=-j.value},B=a=>{T.move(a);if("content"===a.currentTarget.dataset.id&&!v.contentDraggable)return;const e=T.deltaY.value+D;j.value=-(a=>{const e=Math.abs(a),{min:t,max:l}=z.value;return e>l?-(l+.2*(e-l)):e<t?-(t-.2*(t-e)):a})(e)},I=()=>{P.value=!1,j.value=H(y.value,j.value),j.value!==-D&&x("heightChange",{height:j.value})};return l(z,(()=>{j.value=H(y.value,j.value)}),{immediate:!0}),l((()=>j.value),(a=>{v.contentDraggable&&(a==z.value.max?p.value=!0:p.value=!1)}),{immediate:!0}),(e,t)=>{const l=m,f=g;return s(),o(l,{class:u([i(b)(),{"z-safe-area-bottom":a.safeAreaInsetBottom}]),style:h(C.value),"data-id":"root",onTouchstartPassive:A,onTouchmove:B,onTouchend:I,onTouchcancel:I},{default:n((()=>[r(l,{class:u(i(b)("header"))},{default:n((()=>[r(l,{class:u(i(b)("header-bar"))},null,8,["class"])])),_:1},8,["class"]),r(f,{class:u(i(b)("content")),"scroll-y":p.value,"data-id":"content",onTouchmove:c(B,["stop","prevent"])},{default:n((()=>[d(e.$slots,"default",{},void 0,!0)])),_:3},8,["class","scroll-y"])])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-b2cd8d30"]]),L=a({__name:"floatingPanel",setup(a){const l=t((()=>z().windowHeight)),u=[100,Math.round(.4*l.value),Math.round(.7*l.value)],i=e(u[0]);return(a,e)=>{const t=A(v("z-cell"),P),l=A(v("z-cell-group"),I),c=A(v("z-floating-panel"),J),d=A(v("z-tab"),Y),h=y,g=m,f=A(v("z-tabs"),G),z=A(v("DemoPage"),B);return s(),o(z,{title:"FloatingPanel"},{default:n((()=>[r(g,{class:"demo-floating-panel"},{default:n((()=>[r(f,null,{default:n((()=>[r(d,{title:"基础用法"},{default:n((()=>[r(c,null,{default:n((()=>[r(l,null,{default:n((()=>[(s(),p(b,null,_(26,(a=>r(t,{key:a,title:String.fromCharCode(a+64),size:"large"},null,8,["title"]))),64))])),_:1})])),_:1})])),_:1}),r(d,{title:"自定义锚点"},{default:n((()=>[r(c,{height:i.value,"onUpdate:height":e[0]||(e[0]=a=>i.value=a),anchors:u},{default:n((()=>[r(g,{style:{padding:"30rpx","text-align":"center"}},{default:n((()=>[r(h,null,{default:n((()=>[x("面板显示高度 "+j(i.value.toFixed(0))+" px",1)])),_:1})])),_:1})])),_:1},8,["height"])])),_:1}),r(d,{title:"仅头部拖拽"},{default:n((()=>[r(c,{"content-draggable":!1},{default:n((()=>[r(g,{style:{padding:"30rpx","text-align":"center"}},{default:n((()=>[r(h,null,{default:n((()=>[x("内容不可拖拽")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}});export{L as default};
