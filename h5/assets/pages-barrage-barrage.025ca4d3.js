import{d as a,k as e,l as t,I as l,o as s,c as o,w as d,x as u,e as i,F as n,r,n as m,y as p,b as v,t as y,p as c,G as f,i as x,v as _,L as g,_ as h,m as b,E as w,a as V}from"./index-f30f5313.js";import{m as k,t as z,w as P,l as S,i as B,j as E,C as $,v as C,x as D,r as I,a as j,_ as M}from"./DemoPage.cf3c40e0.js";const T=h(a({name:"ZBarrage",options:{virtualHost:!0},props:{top:k(10),rows:k(4),duration:k(4e3),autoPlay:z,delay:P(300),modelValue:S()},emits:["update:modelValue"],setup(a,{expose:h,emit:b}){const[w,V]=B("barrage");E(w);const k=a,z=b,P=g(),S=V("item"),I=e(0),j=e([]),M=e(!0),T=e(k.autoPlay),A=({id:a,text:e},t)=>{const l=((a,e=k.delay)=>{const t={};return t.className=S,t.innerText=String(a),t.style={},t.dataset={},t.style.animationDuration=`${k.duration}ms`,t.style.animationDelay=`${e}ms`,t.style.animationTimingFunction="linear",t.show=!0,t})(e,M.value?t*k.delay:void 0);k.autoPlay||!1!==T.value||(l.style.animationPlayState="paused"),I.value++;const s=(I.value-1)%+k.rows*_(50)+ +k.top;l.style.top=`${s}px`,l.dataset.id=String(a),j.value.push(l)},F=(a,e)=>{const t=new Map(e.map((a=>[a.id,a])));a.forEach(((a,e)=>{t.has(a.id)?t.delete(a.id):A(a,e)})),t.forEach((a=>{const e=j.value.findIndex((e=>e.dataset.id===String(a.id)));e>-1&&j.value.splice(e,1)})),M.value=!1};t((()=>k.modelValue.slice()),((a,e)=>{F(a||[],e||[])}),{deep:!0});const N=e({});l((()=>{$((()=>{D(P,".z-barrage").then((a=>{N.value["--move-distance"]=`-${a.width}px`,F(k.modelValue,[])}))}))}));const U=()=>{T.value=!0,j.value.forEach((a=>{a.style={...a.style,animationPlayState:"running"}}))},G=()=>{T.value=!1,j.value.forEach((a=>{a.style={...a.style,animationPlayState:"paused"}}))};return C({play:U,pause:G}),h({play:U,pause:G}),(a,e)=>{const t=x;return s(),o(t,{class:m(f(V)()),style:p([N.value])},{default:d((()=>[u(a.$slots,"default",{},void 0,!0),(s(!0),i(n,null,r(j.value,((a,e)=>{var l;return s(),i(n,{key:e},[a.show?(s(),o(t,{key:0,class:m(null==a?void 0:a.className),"data-id":null==(l=null==a?void 0:a.dataset)?void 0:l.id,style:p(a.style),onAnimationend:e=>((a,e)=>{a.show=!1,j.value.filter((a=>a.show)).length||z("update:modelValue",[])})(a)},{default:d((()=>[v(y(a.innerText),1)])),_:2},1032,["class","data-id","style","onAnimationend"])):c("",!0)],64)})),128))])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-d152ba59"]]),A=h(a({__name:"barrage",setup(a){const l=[{id:11,text:"zebra-ui"},{id:12,text:"666666"},{id:13,text:"哈哈哈哈哈哈"},{id:14,text:"uniapp"},{id:15,text:"zebra-swiper"},{id:16,text:"嘻嘻嘻"},{id:17,text:"这条弹幕很长这条弹幕很长这条弹幕很长这条弹幕很长这条弹幕很长"}],u=e([...l]),i=()=>{u.value.push({id:Math.random(),text:"Barrage"})},n=e([...l]),r=e(),m=()=>{n.value.push({id:Math.random(),text:"Barrage"})},p=e(!1);return t(p,(()=>{var a,e;p.value?null==(a=r.value)||a.play():null==(e=r.value)||e.pause()})),(a,e)=>{const t=x,l=I(b("z-barrage"),T),c=I(b("z-button"),j),f=w("demo-block"),_=I(b("DemoPage"),M);return s(),o(_,{title:"Barrage"},{default:d((()=>[V(t,{class:"demo-barrage"},{default:d((()=>[V(f,{title:"基础用法"},{default:d((()=>[V(l,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=a=>u.value=a)},{default:d((()=>[V(t,{class:"video"})])),_:1},8,["modelValue"]),V(t,{style:{"margin-top":"20rpx"}},{default:d((()=>[V(c,{onClick:i,type:"primary",size:"small"},{default:d((()=>[v(" 弹幕 ")])),_:1})])),_:1})])),_:1}),V(f,{title:"视频弹幕"},{default:d((()=>[V(l,{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value=a),ref_key:"videoBarrage",ref:r,"auto-play":!1},{default:d((()=>[V(t,{class:"video"})])),_:1},8,["modelValue"]),V(t,{style:{"margin-top":"10px"}},{default:d((()=>[V(c,{onClick:m,type:"primary",size:"small",disabled:!p.value},{default:d((()=>[v(" 弹幕 ")])),_:1},8,["disabled"]),V(c,{"custom-style":{"margin-left":"20rpx"},onClick:e[2]||(e[2]=a=>((a=!p.value)=>{p.value=a})()),size:"small"},{default:d((()=>[v(y(p.value?"暂停":"播放"),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-56917e24"]]);export{A as default};
