import{d as a,k as e,D as t,I as s,ad as l,l as o,a1 as i,ae as u,af as n,o as f,c as v,w as c,x as r,G as x,p as d,n as p,z as g,y as m,L as y,i as b,_ as h,m as _,a as j,b as k,t as z}from"./index-f30f5313.js";import{w as T,s as w,i as C,j as F,K as $,L as P,y as B,z as D,C as I,x as L,a3 as O,r as S,_ as U}from"./DemoPage.cf3c40e0.js";import{u as G}from"./use-touch.6469fcb8.js";import{c as H}from"./closest.9c1a5909.js";import{_ as J,a as K}from"./z-tabs.b35f9c58.js";import{u as R}from"./z-toast.1a41a7b4.js";import"./z-dialog.a22a98be.js";import"./useParent.17bb91a9.js";import"./use-id.cdfa0884.js";import"./useChildren.47d4431b.js";import"./z-sticky.f67df7ce.js";const X=h(a({name:"ZFloatingBubble",options:{virtualHost:!0},props:{gap:T(24),icon:String,axis:w("y"),magnetic:String,offset:{type:Object,default:()=>({x:-1,y:-1})}},emits:["click","update:offset","offsetChange"],setup(a,{emit:h}){const _=y(),[j,k]=C("floating-bubble");F(j);const z=a,T=h,w=e(),S=e({x:0,y:0,width:0,height:0}),U=t((()=>({top:z.gap,right:$.value-S.value.width-z.gap,bottom:P.value-S.value.height-z.gap,left:z.gap}))),J=e(!1);let K=!1;const R=t((()=>{const a={},e=B(S.value.x),t=B(S.value.y);return a.transform=`translate3d(${e}, ${t}, 0)`,!J.value&&K||(a.transition="none"),a})),X=()=>{Q.value&&I((()=>{L(_,".z-floating-bubble").then((a=>{const{width:e,height:t}=a,{offset:s}=z;S.value={x:s.x>-1?s.x:$.value-e-z.gap,y:s.y>-1?s.y:P.value-t-z.gap,width:e,height:t}}))}))},Y=G();let Z=0,q=0;const A=a=>{Y.start(a),J.value=!0,Z=S.value.x,q=S.value.y},E=a=>{if(Y.move(a),"lock"!==z.axis&&!Y.isTap.value){if("x"===z.axis||"xy"===z.axis){let a=Z+Y.deltaX.value;a<U.value.left&&(a=U.value.left),a>U.value.right&&(a=U.value.right),S.value.x=a}if("y"===z.axis||"xy"===z.axis){let a=q+Y.deltaY.value;a<U.value.top&&(a=U.value.top),a>U.value.bottom&&(a=U.value.bottom),S.value.y=a}const a=O(S.value,["x","y"]);T("update:offset",a)}},M=()=>{J.value=!1,l((()=>{if("x"===z.magnetic){const a=H([U.value.left,U.value.right],S.value.x);S.value.x=a}if("y"===z.magnetic){const a=H([U.value.top,U.value.bottom],S.value.y);S.value.y=a}if(!Y.isTap.value){const a=O(S.value,["x","y"]);T("update:offset",a),Z===a.x&&q===a.y||T("offsetChange",a)}}))},N=a=>{Y.isTap.value&&T("click",a)};s((()=>{X(),l((()=>{K=!0}))})),o([$,P,()=>z.gap,()=>z.offset],X);const Q=e(!0);return i((()=>{Q.value=!0})),(a,e)=>{const t=b;return u((f(),v(t,{class:p(x(k)()),ref_key:"rootRef",ref:w,onTouchstartPassive:A,onTouchmove:g(E,["stop","prevent"]),onTouchend:M,onTouchcancel:M,onClickCapture:N,style:m(R.value)},{default:c((()=>[r(a.$slots,"default",{},void 0,!0),x(_).slots.default?d("",!0):(f(),v(D,{key:0,name:z.icon,size:"var(--z-floating-bubble-icon-size)"},null,8,["name"]))])),_:3},8,["class","style"])),[[n,Q.value]])}}}),[["__scopeId","data-v-69fa0e20"]]),Y=h(a({__name:"floatingBubble",setup(a){const t=R(),s=a=>{t.showToast(`x: ${a.x.toFixed(0)}, y: ${a.y.toFixed(0)}`)},l=()=>{t.showToast("点击气泡")},o=e(0),i=e({x:200,y:400});return(a,e)=>{const t=b,u=S(_("z-floating-bubble"),X),n=S(_("z-tab"),J),r=S(_("z-tabs"),K),x=S(_("DemoPage"),U);return f(),v(x,{title:"FloatingBubble"},{default:c((()=>[j(t,{class:"demo-floating-bubble"},{default:c((()=>[j(r,{active:o.value,"onUpdate:active":e[1]||(e[1]=a=>o.value=a)},{default:c((()=>[j(n,{title:"基础用法"},{default:c((()=>[j(t,{class:"text"},{default:c((()=>[k("在 x 轴默认位置，只允许 y 轴方向拖拽")])),_:1}),0===o.value?(f(),v(u,{key:0,icon:"setting-fill",onClick:l})):d("",!0)])),_:1}),j(n,{title:"自由拖拽和磁吸"},{default:c((()=>[j(t,{class:"text"},{default:c((()=>[k("允许 x 和 y 轴方向拖拽，吸附到 x 轴方向最近一边")])),_:1}),1===o.value?(f(),v(u,{key:0,icon:"setting-fill",axis:"xy",magnetic:"x",onOffsetChange:s})):d("",!0)])),_:1}),j(n,{title:"双向绑定"},{default:c((()=>[j(t,{class:"text"},{default:c((()=>[k(" 使用 offset 控制位置, x："+z(i.value.x.toFixed(0))+" y:"+z(i.value.y.toFixed(0)),1)])),_:1}),2===o.value?(f(),v(u,{key:0,icon:"setting-fill",offset:i.value,"onUpdate:offset":e[0]||(e[0]=a=>i.value=a),axis:"xy"},null,8,["offset"])):d("",!0)])),_:1})])),_:1},8,["active"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-e61515e5"]]);export{Y as default};
