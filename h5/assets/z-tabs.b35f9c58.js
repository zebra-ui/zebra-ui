import{d as e,k as t,l as a,a5 as l,D as s,I as i,ad as o,a3 as n,G as r,o as c,c as d,w as u,a as v,n as h,x as p,y as f,ae as b,af as m,i as y,L as g,_ as w,e as k,F as x,r as _,b as z,t as C,p as I,C as S,S as $}from"./index-f30f5313.js";import{n as T,E as B,t as j,i as R,j as H,v as D,x as M,m as O,w as P,H as X,B as N,I as Z,b as F,J as W,y as A,D as E,F as G,C as L,G as J}from"./DemoPage.cf3c40e0.js";import{u as V}from"./useParent.17bb91a9.js";import{u as q}from"./use-id.cdfa0884.js";import{u as K}from"./useChildren.47d4431b.js";import{u as Q}from"./use-touch.6469fcb8.js";import{_ as U}from"./z-sticky.f67df7ce.js";const Y=w(e({name:"ZTab",options:{virtualHost:!0},props:{dot:Boolean,name:T,badge:T,title:String,disabled:Boolean,titleClass:B,titleStyle:[String,Object],showZeroBadge:j,slotContent:null},setup(e){const[w,k]=R("tab");H(w);const x=e,_=q(),z=t(!1),C=g(),{parent:I,index:S}=V("z-tabs"),$=()=>x.name?x.name:S.value,T=()=>{z.value=!0,I.props.lazyRender&&o((()=>{I.onRendered($(),x.title)}))},B=t(!1),{animated:j,swipeable:O,scrollspy:P}=I.props,X=t(P||B.value),N=t(!B.value);a((()=>[I.currentName.value]),(()=>{const e=$()===I.currentName.value;e&&!z.value&&T(),B.value=e}),{immediate:!0}),a((()=>[P,B.value]),(()=>{X.value=P||B.value,B.value?N.value=!1:N.value=!0}),{immediate:!0});const Z=l({offset:0,inited:!1,mounted:!1}),F=s((()=>{const e={};return I&&(I.size.value&&(e.width=`${I.size.value}px`),Z.offset&&(e.transform=`translateX(${Z.offset}px)`)),{...e}})),W=t(0);return i((()=>{o((()=>{Z.mounted=!0,M(C,".z-tab__panel").then((e=>{W.value=e.height}))}))})),n("z-tab",B),D({id:_,active:B,bem:k,init:T,setOffset:e=>{Z.offset=e},heightRect:W}),(e,t)=>{const a=y;return r(j)||r(O)?(c(),d(a,{key:0,class:h(["swipe-item",r(k)("panel-wrapper",{inactive:N.value})]),style:f([F.value])},{default:u((()=>[v(a,{class:h(r(k)("panel"))},{default:u((()=>[p(e.$slots,"default",{},void 0,!0)])),_:3},8,["class"])])),_:3},8,["class","style"])):b((c(),d(a,{key:1,id:r(_),class:h(r(k)("panel")),tabindex:X.value?0:-1},{default:u((()=>[p(e.$slots,"default",{},void 0,!0)])),_:3},8,["id","class","tabindex"])),[[m,X.value]])}}}),[["__scopeId","data-v-991c9d8a"]]),ee=w(e({name:"ZTabs",options:{virtualHost:!0},props:{type:{type:String,default:"line"},color:String,border:Boolean,sticky:Boolean,shrink:Boolean,active:O(0),duration:O(.3),animated:Boolean,ellipsis:j,swipeable:Boolean,scrollspy:Boolean,offsetTop:P(0),background:String,lazyRender:j,showHeader:j,lineWidth:T,lineHeight:T,beforeChange:Function,swipeThreshold:O(5),titleActiveColor:String,titleInactiveColor:String,customNavbar:Boolean,customStyle:Object,titleStyle:Object},emits:["change","scroll","rendered","clickTab","update:active"],setup(e,{expose:n,emit:b}){const m=g(),[w,T]=R("tabs"),B=b,j=e,O=t(0),P=q(),V=(e,t)=>q(e)+t,[Y,ee]=X(),{children:te,linkChildren:ae}=K(w),le=l({inited:!1,position:"",lineStyle:{},currentIndex:-1}),se=s((()=>te.length>+j.swipeThreshold||!j.ellipsis||j.shrink)),ie=s((()=>({borderColor:j.color,background:j.background}))),oe=e=>{const t={},{type:a,color:l}=j,{disabled:s}=e,i=e.active,o=j.titleActiveColor,n=j.titleInactiveColor;l&&"card"===a&&(t.borderColor=l,s||(i?t.backgroundColor=l:t.color=l));const r=i?o:n;return r&&(t.color=r),{...t,...j.titleStyle,...e.titleStyle}},ne=(e,t)=>e.name?e.name:t,re=s((()=>{const e=te[le.currentIndex];if(e)return ne(e,le.currentIndex)})),ce=s((()=>j.offsetTop)),de=e=>{se.value&&Promise.all([M(m,".z-tabs__nav"),W(m,".z-tab")]).then((([e,t])=>{const a=t[le.currentIndex],l=t.slice(0,le.currentIndex).reduce(((e,t)=>e+t.width),0);O.value=l-(e.width-a.width)/2}))},ue=()=>{const e=le.inited;o((()=>{"line"==j.type&&Promise.all([W(m,".z-tab")]).then((([t])=>{const a=t[le.currentIndex];let l=t.slice(0,le.currentIndex).reduce(((e,t)=>e+t.width),0);l+=a.width/2+(j.ellipsis?0:8);const{lineWidth:s,lineHeight:i}=j,o={width:A(s),backgroundColor:j.color,transform:`translateX(${l}px) translateX(-50%)`};if(e&&(o.transitionDuration=`${j.duration}s`),Z(i)){const e=A(i);o.height=e,o.borderRadius=e}le.lineStyle=o}))}))},ve=(e,t)=>{const a=(e=>{const t=e<le.currentIndex?-1:1;for(;e>=0&&e<te.length;){if(!te[e].disabled)return e;e+=t}})(e);if(!Z(a))return;const l=te[a],s=ne(l,a),i=null!==le.currentIndex;le.currentIndex!==a&&(le.currentIndex=a,t||de(),ue()),s!==j.active&&(B("update:active",s),i&&B("change",s,l.title))},he=(e,t)=>{const a=te.find(((t,a)=>ne(t,a)===e)),l=a?te.indexOf(a):0;ve(l,t)},pe=t(0),fe=(e=!1)=>{if(j.scrollspy){const e=((e,t)=>{let a=0;for(let l=0;l<=e;l++)a+=t[l].heightRect.value;return a-t[e].heightRect.value})(le.currentIndex,te);pe.value=e}},be=(e,t,a)=>{const{title:l,disabled:s}=te[t],i=ne(te[t],t);s||E(j.beforeChange,{args:[i],done:()=>{ve(t),fe()}}),B("clickTab",{name:i,title:l,event:a,disabled:s})},me=e=>{B("scroll",e)},ye=e=>{if(j.scrollspy){const t=((e,t)=>{let a=0;for(let l=0;l<t.length;l++)if(a+=t[l].heightRect.value,e<a-1)return l;return t.length})(e.detail.scrollTop,te);ve(t)}},ge=()=>{ue(),o((()=>{de()}))};a((()=>[j.color,j.duration,j.lineWidth,j.lineHeight]),ue),a((()=>j.active),(e=>{e!==re.value&&he(e)})),a((()=>te.length),(()=>{le.inited&&(he(j.active),ue(),o((()=>{de()})))}));const[we,ke]=R("swipe");H(we);const xe=l({rect:null,width:0,height:0,offset:0,active:0,swiping:!1}),_e=Q(),ze=s((()=>te.length)),Ce=s((()=>xe.width)),Ie=s((()=>_e.deltaX.value)),Se=s((()=>{if(xe.rect){return xe.rect.width-Ce.value*ze.value}return 0})),$e=s((()=>Ce.value?Math.ceil(Math.abs(Se.value)/Ce.value):ze.value)),Te=s((()=>ze.value*Ce.value)),Be=s((()=>(xe.active+ze.value)%ze.value)),je=s((()=>"horizontal"===_e.direction.value)),Re=s((()=>{const e={transitionDuration:(xe.swiping?0:1e3*+j.duration)+"ms",transform:`translateX(${+xe.offset.toFixed(2)}px)`};if(Ce.value){const t="height";e["width"]=`${Te.value}px`,e[t]=j[t]?`${j[t]}px`:""}return e})),He=(e,t=0)=>{let a=e*Ce.value;a=Math.min(a,-Se.value);let l=t-a;return l=J(l,Se.value,0),l},De=({pace:e=0,offset:t=0,emitChange:a})=>{if(ze.value<=1)return;const{active:l}=xe,s=(e=>{const{active:t}=xe;return e?J(t+e,0,$e.value):t})(e),i=He(s,t);xe.active=s,xe.offset=i,a&&s!==l&&ve(Be.value)},Me=()=>{xe.swiping=!0,xe.active<=-1?De({pace:ze.value}):xe.active>=ze.value&&De({pace:-ze.value})},Oe=()=>{Me(),_e.reset(),G((()=>{xe.swiping=!1,De({pace:-1,emitChange:!0})}))},Pe=()=>{Me(),_e.reset(),G((()=>{xe.swiping=!1,De({pace:1,emitChange:!0})}))},Xe=(e=0)=>{L((()=>{M(m,".z-swipe-rect").then((t=>{const a=t;(()=>{const t={width:a.width,height:a.height};xe.rect=t,xe.width=+t.width,xe.height=+t.height,ze.value&&-1===(e=Math.min(ze.value-1,e))&&(e=ze.value-1),xe.active=e,xe.swiping=!0,xe.offset=He(e),te.forEach((e=>{e.setOffset(0)}))})()}))}))};let Ne;const Ze=e=>{!j.swipeable||e.touches.length>1||(_e.start(e),Ne=Date.now(),Me())},Fe=e=>{if(j.swipeable&&xe.swiping&&(_e.move(e),je.value)){0===xe.active&&Ie.value>0||xe.active===ze.value-1&&Ie.value<0||De({offset:Ie.value})}},We=()=>{if(!j.swipeable||!xe.swiping)return;const e=Date.now()-Ne,t=Ie.value/e;if((Math.abs(t)>.25||Math.abs(Ie.value)>Ce.value/2)&&je.value){_e.offsetX.value;let e=0;e=-Math[Ie.value>0?"ceil":"floor"](Ie.value/Ce.value),De({pace:e,emitChange:!0})}else Ie.value&&De({pace:0});xe.swiping=!1},Ae=(e,t={})=>{Me(),_e.reset(),G((()=>{let a;a=e%ze.value,t.immediate?G((()=>{xe.swiping=!1})):xe.swiping=!1,De({pace:a-xe.active,emitChange:!0})}))};D({resize:ge,scrollTo:e=>{o((()=>{he(e),fe(!0)}))},prev:Oe,next:Pe,state:le,swipeTo:Ae}),ae({id:P,props:j,setLine:ue,scrollable:se,onRendered:(e,t)=>B("rendered",e,t),currentName:re,setTitleRefs:ee,scrollIntoView:de,size:Ce,count:ze,activeIndicator:Be}),n({prev:Oe,next:Pe,state:le,resize:ge,swipeTo:Ae}),a(ze,(()=>{(j.animated||j.swipeable)&&Xe(xe.active)}));const Ee=e=>{xe.active!==e&&Ae(e,{immediate:!le.inited})};return a((()=>le.currentIndex),Ee),i((()=>{he(j.active,!0),o((()=>{le.inited=!0,M(m,".z-tabs__wrap-rect").then((e=>{de()}))})),(j.animated||j.swipeable)&&Xe(),Ee(le.currentIndex)})),(t,a)=>{const l=S,s=y,i=$;return c(),d(s,{class:h(["z-tabs-rect",[r(T)([j.type])]]),style:f(e.customStyle)},{default:u((()=>[j.showHeader?(c(),k(x,{key:0},[j.sticky?(c(),d(U,{key:0,container:r(undefined),"offset-top":ce.value,"custom-navbar":e.customNavbar,onScroll:me},{default:u((()=>[v(s,{class:h(["z-tabs__wrap-rect",[r(T)("wrap"),{[r(N)]:"line"===e.type&&e.border}]])},{default:u((()=>[v(i,{class:h(r(T)("scrollview")),"scroll-x":se.value,"scroll-with-animation":!0,"scroll-left":O.value},{default:u((()=>[p(t.$slots,"nav-left",{},void 0,!0),v(s,{class:h(r(T)("nav",[e.type,{shrink:j.shrink,complete:se.value}])),style:f([ie.value,e.color?"border-color: "+e.color:""])},{default:u((()=>[(c(!0),k(x,null,_(r(te),((e,a)=>(c(),d(s,{key:a,id:V("z-tab",a),class:h([e.bem([j.type,{grow:se.value&&!j.shrink,shrink:j.shrink,active:e.active.value,disabled:e.disabled}])]),style:f(oe(e)),tabindex:e.disabled?void 0:e.active.value?0:-1,onClick:e=>be(0,a,e)},{default:u((()=>[e.dot||r(Z)(e.badge)&&""!==e.badge?(c(),d(F,{key:0,dot:e.dot,content:e.badge,"show-zero":e.showZeroBadge},{default:u((()=>[v(l,{class:h(r(T)("text",{ellipsis:!e.scrollable}))},{default:u((()=>[e.title?(c(),k(x,{key:0},[z(C(e.title),1)],64)):p(t.$slots,"title",{key:1},void 0,!0)])),_:2},1032,["class"])])),_:2},1032,["dot","content","show-zero"])):(c(),d(s,{key:1,class:h(e.bem("text",{ellipsis:!e.scrollable}))},{default:u((()=>[e.title?(c(),k(x,{key:0},[z(C(e.title),1)],64)):p(t.$slots,"title",{key:1},void 0,!0)])),_:2},1032,["class"]))])),_:2},1032,["id","class","style","tabindex","onClick"])))),128)),"line"===e.type&&r(te).length?(c(),d(s,{key:0,class:h(r(T)("line")),style:f(le.lineStyle)},null,8,["class","style"])):I("",!0)])),_:3},8,["class","style"]),p(t.$slots,"nav-right",{},void 0,!0)])),_:3},8,["class","scroll-x","scroll-left"])])),_:3},8,["class"])])),_:3},8,["container","offset-top","custom-navbar"])):(c(),d(s,{key:1,class:h(["z-tabs__wrap-rect",[r(T)("wrap"),{[r(N)]:"line"===e.type&&e.border}]])},{default:u((()=>[v(i,{class:h(r(T)("scrollview")),"scroll-x":se.value,"scroll-with-animation":!0,"scroll-left":O.value},{default:u((()=>[p(t.$slots,"nav-left",{},void 0,!0),v(s,{class:h(r(T)("nav",[e.type,{shrink:j.shrink,complete:se.value}])),style:f([ie.value,e.color?"border-color: "+e.color:""])},{default:u((()=>[(c(!0),k(x,null,_(r(te),((e,a)=>(c(),d(s,{key:a,id:V("z-tab",a),class:h([e.bem([j.type,{grow:se.value&&!j.shrink,shrink:j.shrink,active:e.active.value,disabled:e.disabled}])]),style:f(oe(e)),tabindex:e.disabled?void 0:e.active.value?0:-1,onClick:e=>be(0,a,e)},{default:u((()=>[e.dot||r(Z)(e.badge)&&""!==e.badge?(c(),d(F,{key:0,dot:e.dot,content:e.badge,"show-zero":e.showZeroBadge},{default:u((()=>[v(l,{class:h(r(T)("text",{ellipsis:!e.scrollable}))},{default:u((()=>[e.title?(c(),k(x,{key:0},[z(C(e.title),1)],64)):p(t.$slots,"title",{key:1},void 0,!0)])),_:2},1032,["class"])])),_:2},1032,["dot","content","show-zero"])):(c(),d(s,{key:1,class:h(e.bem("text",{ellipsis:!e.scrollable}))},{default:u((()=>[e.title?(c(),k(x,{key:0},[z(C(e.title),1)],64)):p(t.$slots,"title",{key:1,item:e,index:a},void 0,!0)])),_:2},1032,["class"]))])),_:2},1032,["id","class","style","tabindex","onClick"])))),128)),"line"===e.type&&r(te).length?(c(),d(s,{key:0,class:h(r(T)("line")),style:f(le.lineStyle)},null,8,["class","style"])):I("",!0)])),_:3},8,["class","style"]),p(t.$slots,"nav-right",{},void 0,!0)])),_:3},8,["class","scroll-x","scroll-left"])])),_:3},8,["class"]))],64)):I("",!0),v(s,{class:h(r(T)("content",{animated:j.animated||j.swipeable}))},{default:u((()=>[j.animated||j.swipeable?(c(),d(s,{key:0,class:h(["z-swipe-rect",[r(ke)()]])},{default:u((()=>[v(s,{style:f(Re.value),class:h(r(T)("track")),onTouchstartPassive:Ze,onTouchmovePassive:Fe,onTouchend:We,onTouchcancel:We},{default:u((()=>[p(t.$slots,"default",{},void 0,!0)])),_:3},8,["style","class"])])),_:3},8,["class"])):j.scrollspy?(c(),d(i,{key:1,"scroll-y":"",style:{width:"100%",height:"100%"},"scroll-with-animation":"","scroll-top":pe.value,onScroll:ye},{default:u((()=>[p(t.$slots,"default",{},void 0,!0)])),_:3},8,["scroll-top"])):p(t.$slots,"default",{key:2},void 0,!0)])),_:3},8,["class"])])),_:3},8,["class","style"])}}}),[["__scopeId","data-v-6a37976c"]]);export{Y as _,ee as a};
