import{s as e,t,l as a,E as o,i as l,j as s,d as r,a9 as c,z as i,a5 as n,C as u,F as p,x as v,aa as m,y as d,r as h,a as f,_ as y}from"./DemoPage.cf3c40e0.js";import{d as w,k as b,D as g,I as k,l as z,o as _,c as x,w as $,a as C,n as S,G as j,x as O,p as A,e as U,F as P,r as T,y as D,b as I,t as B,L as G,ad as E,A as F,i as H,_ as L,m as N,E as R,M as q}from"./index-f30f5313.js";import{u as M}from"./use-sync-prop-ref.7ee3c810.js";import{_ as V,a as Z}from"./z-grid.18231d09.js";import{_ as J}from"./z-picker.f4e3f177.js";import{u as K}from"./z-toast.1a41a7b4.js";import"./z-dialog.a22a98be.js";import"./useParent.17bb91a9.js";import"./useChildren.47d4431b.js";import"./use-touch.6469fcb8.js";const Q=L(w({name:"ZPopover",options:{virtualHost:!0},props:{show:Boolean,theme:e("light"),overlay:t,overlayBackGroud:Boolean,actions:a(),actionsDirection:e("vertical"),trigger:e("click"),duration:Number,showArrow:t,placement:e("bottom"),iconPrefix:String,overlayClass:o,overlayStyle:Object,closeOnClickAction:t,closeOnClickOverlay:t,closeOnClickOutside:t,offset:{type:Array,default:()=>[0,8]},teleport:{type:[String,Object],default:"body"},customStyle:Object},emits:["select","touchstart","update:show"],setup(e,{emit:t}){const[a,o]=l("popover");s(a);const h=G(),f=e,y=t,w=b(),L=M((()=>f.show),(e=>y("update:show",e)));let N=b({});const R=()=>{E((()=>{u((()=>{p((()=>{Promise.all([v(h,".z-popover-wrapper-rect"),v(h,".z-popover-content-rect"),m()]).then((([e,t,a])=>{if(e&&t){const{windowHeight:a}=F(),o=t.width,l=e.width;let s=0;s=o>=l?e.left-(o-l)/2:e.left+(l-o)/2;const r=t.height,c=e.height;let i=0;switch(i=r>=c?e.top-(r-c)/2:e.top+(c-r)/2,f.placement){case"bottom":N.value.top=`calc(var(--z-popover-arrow-size) + ${d(e.height+e.top+3)})`,N.value.left=`calc(${d(s)})`,N.value.bottom="auto",N.value.right="auto";break;case"bottom-start":N.value.top=`calc(var(--z-popover-arrow-size) + ${d(e.height+e.top+3)})`,N.value.left=`${d(e.left)}`,N.value.bottom="auto",N.value.right="auto";break;case"bottom-end":N.value.top=`calc(var(--z-popover-arrow-size) + ${d(e.height+e.top+3)})`,N.value.right=`${d(e.right-e.width)}`,N.value.bottom="auto",N.value.left="auto";break;case"top":N.value.bottom=`calc(var(--z-popover-arrow-size) + ${d(a-e.top+3)})`,N.value.left=`calc(${d(s)})`,N.value.top="auto",N.value.right="auto";break;case"top-start":N.value.bottom=`calc(var(--z-popover-arrow-size) + ${d(a-e.top+3)})`,N.value.left=`${d(e.left)}`,N.value.top="auto",N.value.right="auto";break;case"top-end":N.value.bottom=`calc(var(--z-popover-arrow-size) + ${d(a-e.top+3)})`,N.value.right=`${d(e.right-e.width)}`,N.value.top="auto",N.value.left="auto";break;case"left":N.value.right=`calc(var(--z-popover-arrow-size) + ${d(e.right+3)})`,N.value.top=`calc(${d(i)})`,N.value.left="auto",N.value.bottom="auto";break;case"left-start":N.value.right=`calc(var(--z-popover-arrow-size) + ${d(e.right+3)})`,N.value.top=`${d(e.top)}`,N.value.left="auto",N.value.bottom="auto";break;case"left-end":N.value.right=`calc(var(--z-popover-arrow-size) + ${d(e.right+3)})`,N.value.bottom=`${d(a-e.bottom)}`,N.value.left="auto",N.value.top="auto";break;case"right":N.value.left=`calc(var(--z-popover-arrow-size) + ${d(e.left+e.width+3)})`,N.value.top=`calc(${d(i)})`,N.value.right="auto",N.value.bottom="auto";break;case"right-start":N.value.left=`calc(var(--z-popover-arrow-size) + ${d(e.left+e.width+3)})`,N.value.top=`${d(e.top)}`,N.value.right="auto",N.value.bottom="auto";break;case"right-end":N.value.left=`calc(var(--z-popover-arrow-size) + ${d(e.left+e.width+3)})`,N.value.bottom=`${d(a-e.bottom)}`,N.value.right="auto",N.value.top="auto"}}}))}))}))}))},q=e=>{L.value=e},V=()=>{"click"===f.trigger&&(L.value=!L.value)},Z=g((()=>({marginRight:"var(--z-padding-xs)",fontSize:"var(--z-popover-action-icon-size)"}))),J=g((()=>{const e={position:"fixed",overflow:"visible",backgroundColor:"transparent",transition:"opacity 0.15s, transform 0.15s"},t={top:"50% 100%","top-start":"0 100%","top-end":"100% 100%",left:"100% 50%","left-start":"100% 0","left-end":"100% 100%",right:"0 50%","right-start":"0 0","right-end":"0 100%",bottom:"50% 0","bottom-start":"0 0","bottom-end":"100% 0"};return f.placement&&(e["transform-origin"]=t[f.placement]),{...e,...N.value}})),K=g((()=>f.placement.includes("top")||f.placement.includes("bottom")?"popover-zoom-h":"popover-zoom-w"));return k((()=>{R()})),z((()=>[L.value,f.offset,f.placement]),R),(e,t)=>{const a=H;return _(),x(a,{class:S(j(o)([f.theme])),"data-popper-placement":f.placement,style:D(f.customStyle)},{default:$((()=>[C(a,{class:S(["z-popover-wrapper-rect",j(o)("wrapper")]),onClick:V},{default:$((()=>[O(e.$slots,"reference",{},void 0,!0)])),_:3},8,["class"]),C(r,{ref_key:"popoverRef",ref:w,show:j(L),position:"",transition:K.value,"lock-scroll":!1,"custom-style":J.value,"onUpdate:show":q,overlay:f.overlay,duration:f.duration,"overlay-style":f.overlayStyle,"overlay-class":f.overlayClass,"overlay-back-groud":f.overlayBackGroud,"close-on-click-overlay":f.closeOnClickOverlay},{default:$((()=>[f.showArrow?(_(),x(a,{key:0,class:S(j(o)("arrow"))},null,8,["class"])):A("",!0),C(a,{class:S(["z-popover-content-rect",j(o)("content",f.actionsDirection)])},{default:$((()=>[j(h).slots.default?O(e.$slots,"default",{key:0},void 0,!0):(_(!0),U(P,{key:1},T(f.actions,((t,l)=>(_(),x(a,{key:l,class:S([j(o)("action",{disabled:t.disabled,"with-icon":t.icon}),{[j(c)]:"horizontal"===f.actionsDirection},t.className]),style:D({color:t.color}),onClick:()=>((e,t)=>{e.disabled||(y("select",e,t),f.closeOnClickAction&&(L.value=!1))})(t,l)},{default:$((()=>[j(h).slots.action?O(e.$slots,"action",{key:0,action:t,index:l},void 0,!0):(_(),U(P,{key:1},[t.icon?(_(),x(i,{key:0,name:t.icon,"class-prefix":f.iconPrefix,"custom-style":Z.value},null,8,["name","class-prefix","custom-style"])):A("",!0),C(a,{class:S([j(o)("action-text"),{[j(n)]:"vertical"===f.actionsDirection}])},{default:$((()=>[I(B(t.text),1)])),_:2},1032,["class"])],64))])),_:2},1032,["class","style","onClick"])))),128))])),_:3},8,["class"])])),_:3},8,["show","transition","custom-style","overlay","duration","overlay-style","overlay-class","overlay-back-groud","close-on-click-overlay"])])),_:3},8,["class","data-popper-placement","style"])}}}),[["__scopeId","data-v-866c1e84"]]),W=L(w({__name:"popover",setup(e){const t=K(),a=b([{text:"选项一"},{text:"选项二"},{text:"选项三"}]),o=[{text:"选项一"},{text:"选项二"}],l=[{text:"选项一",icon:"plus-circle"},{text:"选项二",icon:"minus-circle"},{text:"选项三",icon:"message"}],s=[{text:"选项一",disabled:!0},{text:"选项二",disabled:!0},{text:"选项三"}],r=["top","top-start","top-end","left","left-start","left-end","right","right-start","right-end","bottom","bottom-start","bottom-end"].map((e=>({text:e,value:e}))),c=b({horizontal:!1,vertical:!1,showIcon:!1,placement:!1,darkTheme:!1,lightTheme:!1,customContent:!1,disableAction:!1}),i=b("top"),n=e=>{setTimeout((()=>{c.value.placement=!0,i.value=e.selectedValues[0]}))},u=e=>t.showToast(e.text);return(e,t)=>{const p=h(N("z-button"),f),v=h(N("z-popover"),Q),m=R("demo-block"),d=h(N("z-grid-item"),V),w=h(N("z-grid"),Z),b=H,g=h(N("z-picker"),J),k=h(N("DemoPage"),y);return _(),x(k,{title:"Popover"},{default:$((()=>[C(b,{class:"demo-popover"},{default:$((()=>[C(m,{title:"基础用法"},{default:$((()=>[C(v,{show:c.value.lightTheme,"onUpdate:show":t[0]||(t[0]=e=>c.value.lightTheme=e),actions:a.value,placement:"bottom-start",onSelect:u},{reference:$((()=>[C(p,{type:"primary"},{default:$((()=>[I(" 浅色风格 ")])),_:1})])),_:1},8,["show","actions"]),C(v,{show:c.value.darkTheme,"onUpdate:show":t[1]||(t[1]=e=>c.value.darkTheme=e),"custom-style":{"margin-left":"30rpx"},theme:"dark",actions:a.value,onSelect:u},{reference:$((()=>[C(p,{type:"primary"},{default:$((()=>[I(" 深色风格 ")])),_:1})])),_:1},8,["show","actions"])])),_:1}),C(m,{title:"排列方向"},{default:$((()=>[C(v,{show:c.value.horizontal,"onUpdate:show":t[2]||(t[2]=e=>c.value.horizontal=e),actions:a.value,"actions-direction":"horizontal",placement:"bottom-start",onSelect:u},{reference:$((()=>[C(p,{type:"primary"},{default:$((()=>[I(" 水平排列 ")])),_:1})])),_:1},8,["show","actions"]),C(v,{show:c.value.vertical,"onUpdate:show":t[3]||(t[3]=e=>c.value.vertical=e),"custom-style":{"margin-left":"30rpx"},actions:a.value,onSelect:u},{reference:$((()=>[C(p,{type:"primary"},{default:$((()=>[I(" 垂直排列 ")])),_:1})])),_:1},8,["show","actions"])])),_:1}),C(m,{title:"选项配置"},{default:$((()=>[C(v,{show:c.value.showIcon,"onUpdate:show":t[4]||(t[4]=e=>c.value.showIcon=e),actions:l,placement:"bottom-start",onSelect:u},{reference:$((()=>[C(p,{type:"primary"},{default:$((()=>[I(" 展示图标 ")])),_:1})])),_:1},8,["show"]),C(v,{show:c.value.disableAction,"onUpdate:show":t[5]||(t[5]=e=>c.value.disableAction=e),"custom-style":{"margin-left":"30rpx"},actions:s,onSelect:u},{reference:$((()=>[C(p,{type:"primary"},{default:$((()=>[I(" 禁用选项 ")])),_:1})])),_:1},8,["show"])])),_:1}),C(m,{title:"自定义内容"},{default:$((()=>[C(v,{show:c.value.customContent,"onUpdate:show":t[7]||(t[7]=e=>c.value.customContent=e),placement:"top-start",onSelect:u},{reference:$((()=>[C(p,{type:"primary"},{default:$((()=>[I(" 自定义内容 ")])),_:1})])),default:$((()=>[C(w,{square:"",clickable:"",border:!1,"column-num":"3","custom-style":{width:"480rpx"}},{default:$((()=>[(_(),U(P,null,T(6,(e=>C(d,{key:e,icon:"image",text:"选项",onClick:t[6]||(t[6]=e=>c.value.customContent=!1)}))),64))])),_:1})])),_:1},8,["show"])])),_:1}),C(m,{title:"弹出位置"},{default:$((()=>[C(b,{class:"demo-popover-box"},{default:$((()=>[C(v,{show:c.value.placement,"onUpdate:show":t[8]||(t[8]=e=>c.value.placement=e),theme:"dark",actions:o,placement:i.value,onSelect:u},{reference:$((()=>[q("div",{class:"demo-popover-refer"})])),_:1},8,["show","placement"])])),_:1}),C(g,{columns:j(r),"show-toolbar":!1,onChange:n},null,8,["columns"])])),_:1}),C(m,{title:"非受控模式"},{default:$((()=>[C(v,{actions:a.value,placement:"top-start",onSelect:u},{reference:$((()=>[C(p,{type:"primary"},{default:$((()=>[I(" 非受控模式 ")])),_:1})])),_:1},8,["actions"])])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-a80d55a9"]]);export{W as default};
